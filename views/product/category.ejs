<%- include('../inc/top') %>
<div class="container" style="min-height: 700px;" >

  <div style="text-align: center;margin-top: 20px;">
    <h1>Danh sách các loại sản phẩm</h1>
   </div>

   <div style="margin-bottom: 20px; margin-top: 30px;">
    <form action="/product/searchCategory" method="GET" role="search">
      <div class="input-group rounded">
        <input
          type="search"
          class="form-control rounded"
          placeholder="Search"
          name="name"
          aria-describedby="search-addon"
        />
        <button
          type="submit"
          style="
            display: inline-block;
            line-height: 30px;
            padding: 0 50px;
            -webkit-transition: all 0.4s ease;
            -o-transition: all 0.4s ease;
            -moz-transition: all 0.4s ease;
            transition: all 0.4s ease;
            cursor: pointer;
            font-size: 15px;
            border-radius: 6px;
            margin-left: 5px;
            text-transform: uppercase;
            font-weight: 700;
            color: #fff;
            background-color: blue;
            font-family: inherit;
          "
        >
          <i class="fa fa-search"></i>
        </button>
      </div>
    </form>
  </div>

   <div class="d-grid gap-2 d-md-flex justify-content-md-end">
     
     <a href="/product/addCategory" class="m-1 btn btn-danger me-md-2 ">Thêm loại sản phẩm</a>
   </div>
    <div class="mt-2">

      <div class="card shadow-sm p-3 mb-5 bg-white rounded" style="padding: 30px;">
        <div class="table table-striped">
      <table id="myTable" class="table table-responsive-xl">
        <thead class="thead-dark">
          <tr>
            <th scope="col" style="text-align: center;">id</th>
            <th scope="col" style="text-align: center;">Tên Thể Loại </th>
            <th scope="col" style="text-align: center;">Tổng số lượng </th>
            <!-- <th></th> -->
            <th scope="col">&nbsp;</th>
          </tr>
        </thead>
        <tbody>
            <% listLoai.forEach(function(item) { %>
                <tr>
                    <td style="text-align: center;"><%= item._id %></td>
                    <td style="text-align: center;"><%= item.name %></td>
                    <td style="text-align: center;">
                      
                      <% if (posts.length > 0) { %>
                        <% let totalQuantity = 0; %>
                        <% let tong = 0 %>
                        <% posts.reverse().forEach((data) => { %>
                              
                            <!-- Khởi tạo biến totalQuantity -->
                            <% if ( item._id.toLocaleString()  === data.id_cat._id.toLocaleString()) { %>
                              <% data.sizes.forEach(function(size) { %>
                                <% totalQuantity += size.quantity; %>
                            <% }); %> 
                              
                                <!-- Tính tổng số lượng -->
                            <% }  else { %> 
                              
                              <% } %>
                            <!-- Hiển thị tổng số lượng -->
                        <% }); %>
                        <%= totalQuantity.toLocaleString() %>
                    <% } else { %>
                        <p style="font-size: 18px">Không tìm thấy sản phẩm phù hợp.</p>
                    <% } %>
                    
                    </td>
                    <!-- <td>
                      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
           
                       <a href="/product/updateCategory/<%= item._id  %>" > <img src="/images/ud.png" width="30" height="30" class="rounded-circle " alt=""></a>
                      </div>
                    </td> -->
                    <td>
                                          
                    </td>   
                </tr>
            <% }); %>

            
        </tbody>
      </table>
    </div>
  </div>
  </div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<%- include('../inc/bottom') %>
